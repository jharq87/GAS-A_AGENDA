<script>
  // Funci√≥n que crea una tabla HTML a partir de un conjunto de datos
  function makeTabCont() {
    // Obtiene los datos del servidor usando Google Apps Script
    google.script.run
      .withSuccessHandler(function (obj) {
        // Elimina una tabla existente con el identificador "tCont"
        let table = document.getElementById("tCont");
        if (table) table.remove();

        // Crea una nueva tabla con el identificador "tCont"
        table = document.createElement("table");
        table.id = "tCont";

        // Crea el encabezado y cuerpo de la tabla
        let tbHeader = document.createElement("thead");
        let tbBody = document.createElement("tbody");

        // Encabezado de la tabla:
        let encabezado = document.createElement("tr");
        for (let e = 0; e < obj[0].length; e++) {
          let cell = document.createElement("td");
          cell.textContent = obj[0][e];
          encabezado.appendChild(cell);
        }
        tbHeader.appendChild(encabezado);
        // Agrega el header a la tabla:
        table.appendChild(tbHeader);

        //Cuerpo de la tabla:
        // Recorre las filas de los datos
        for (let i = 1; i < obj.length; i++) {
          // Crea una fila para cada fila de datos
          let row = document.createElement("tr");

          // Recorre las celdas de cada fila
          for (let j = 0; j < obj[i].length; j++) {
            // Crea una celda para cada celda de la fila
            let cell = document.createElement("td");
            cell.textContent = obj[i][j];
            // Agrega la celda a la fila actual
            row.appendChild(cell);
          }
          tbBody.appendChild(row);
        }

        // Agrega el cuerpo a la tabla:
        table.appendChild(tbBody);

        // Aplica estilos al encabezado y la tabla:
        tbHeader.classList.add("table-dark");
        table.classList.add("table", "table-striped", "border", "border-2");

        //Agrega la tabla al contenedor:
        document.getElementById("divCont").appendChild(table);
      })
      .getContact(); // Obtiene los datos del servidor
  }
</script>
